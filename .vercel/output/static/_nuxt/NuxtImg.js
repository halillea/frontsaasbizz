import{E as _,G as j,H as q,I as O,J as P,K as L,L as W,C,h as p,r as R,M as U,N as H,i as B,c as D,O as T,o as F,P as z,Q as J}from"./entry.js";async function Q(e,t){return await V(t).catch(r=>(console.error("Failed to get image meta for "+t,r+""),{width:0,height:0,ratio:0}))}async function V(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,i)=>{const r=new Image;r.onload=()=>{const s={width:r.width,height:r.height,ratio:r.width/r.height};t(s)},r.onerror=s=>i(s),r.src=e})}function G(e=""){if(e===void 0||!e.length)return[];const t=new Set;for(const i of e.split(" ")){const r=Number.parseInt(i.replace("x",""));r&&t.add(r)}return Array.from(t)}function Y(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function y(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function K(e){const t={};if(typeof e=="string")for(const i of e.split(/[\s,]+/).filter(r=>r)){const r=i.split(":");r.length!==2?t["1px"]=r[0].trim():t[r[0].trim()]=r[1].trim()}else Object.assign(t,e);return t}function X(e){const t={options:e},i=(s,o={})=>x(t,s,o),r=((s,o,a)=>i(s,_({modifiers:o},a)).url);for(const s in e.presets)r[s]=((o,a,c)=>r(o,a,{...e.presets[s],...c}));return r.options=e,r.getImage=i,r.getMeta=((s,o)=>Z(t,s,o)),r.getSizes=((s,o)=>te(t,s,o)),t.$img=r,r}async function Z(e,t,i){const r=x(e,t,{...i});return typeof r.getMeta=="function"?await r.getMeta():await Q(e,r.url)}function x(e,t,i){if(t&&typeof t!="string")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(!t||t.startsWith("data:"))return{url:t};const{setup:r,defaults:s}=ee(e,i.provider||e.options.provider),o=r(),a=$(e,i.preset);if(t=q(t)?t:j(t),!o.supportsAlias){for(const u in e.options.alias)if(t.startsWith(u)){const m=e.options.alias[u];m&&(t=O(m,t.slice(u.length)))}}if(o.validateDomains&&q(t)){const u=P(t).host;if(!e.options.domains.find(m=>m===u))return{url:t}}const c=_(i,a,s),f={...c,modifiers:{...c.modifiers,width:c.modifiers?.width?y(c.modifiers.width):void 0,height:c.modifiers?.height?y(c.modifiers.height):void 0}},g=o.getImage(t,f,e);return g.format||=f.modifiers.format||"",g}function ee(e,t){const i=e.options.providers[t];if(!i)throw new Error("Unknown provider: "+t);return i}function $(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function te(e,t,i){const r=$(e,i.preset),s=_(i,r),o=y(s.modifiers?.width),a=y(s.modifiers?.height),c=s.sizes?K(s.sizes):{},f=s.densities?.trim(),g=f?G(f):e.options.densities;Y(g);const u=o&&a?a/o:0,m=[],h=[];if(Object.keys(c).length>=1){for(const d in c){const n=M(d,String(c[d]),a,u,e);if(n!==void 0){m.push({size:n.size,screenMaxWidth:n.screenMaxWidth,media:`(max-width: ${n.screenMaxWidth}px)`});for(const l of g)h.push({width:n._cWidth*l,src:I(e,t,i,n,l)})}}re(m)}else for(const d of g){const n=Object.keys(c)[0];let l=n?M(n,String(c[n]),a,u,e):void 0;l===void 0&&(l={size:"",screenMaxWidth:0,_cWidth:i.modifiers?.width,_cHeight:i.modifiers?.height}),h.push({width:d,src:I(e,t,i,l,d)})}ie(h);const w=h[h.length-1],v=m.length?m.map(d=>`${d.media?d.media+" ":""}${d.size}`).join(", "):void 0,S=v?"w":"x",b=h.map(d=>`${d.src} ${d.width}${S}`).join(", ");return{sizes:v,srcset:b,src:w?.src}}function M(e,t,i,r,s){const o=s.options.screens&&s.options.screens[e]||Number.parseInt(e),a=t.endsWith("vw");if(!a&&/^\d+$/.test(t)&&(t=t+"px"),!a&&!t.endsWith("px"))return;let c=Number.parseInt(t);if(!o||!c)return;a&&(c=Math.round(c/100*o));const f=r?Math.round(c*r):i;return{size:t,screenMaxWidth:o,_cWidth:c,_cHeight:f}}function I(e,t,i,r,s){return e.$img(t,{...i.modifiers,width:r._cWidth?r._cWidth*s:void 0,height:r._cHeight?r._cHeight*s:void 0},i)}function re(e){e.sort((i,r)=>i.screenMaxWidth-r.screenMaxWidth);let t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.media===t&&e.splice(i,1),t=r.media}for(let i=0;i<e.length;i++)e[i].media=e[i+1]?.media||""}function ie(e){e.sort((i,r)=>i.width-r.width);let t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.width===t&&e.splice(i,1),t=r.width}}function se(e){let t;return()=>t||(t=typeof e=="function"?e():e,t)}const ne=se({validateDomains:!0,getImage:(e,{modifiers:t,baseURL:i="/_vercel/image"},r)=>{const s=Object.values(r.options.screens||{}).sort((c,f)=>c-f),o=s[s.length-1]||0;let a=Number(t?.width||0);return a?s.includes(a)||(a=s.find(c=>c>a)||o):a=o,{url:i+"?"+L({url:e,w:String(a),q:String(t?.quality||"100")})}}}),oe={screens:{sm:640,md:768,lg:1024,xl:1280,"2xl":1536},presets:{},provider:"vercel",domains:[],alias:{},densities:[1,2],format:["avif","webp","webp"],quality:80,provider:"vercel",providers:{vercel:{setup:ne,defaults:{}}}},k=e=>{const t=C(),i=W();return i.$img||i._img||(i._img=X({...oe,event:i.ssrContext?.event,nuxt:{baseURL:t.app.baseURL},runtimeConfig:t}))};function ae(e){performance?.mark?.("mark_feature_usage",{detail:{feature:e}})}const ce=e=>{const t=k(),i=p(()=>({provider:e.provider,preset:e.preset})),r=p(()=>({width:y(e.width),height:y(e.height),crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,nonce:e.nonce})),s=p(()=>({...e.modifiers,width:e.width,height:e.height,format:e.format,quality:e.quality||t.options.quality,background:e.background,fit:e.fit}));return{providerOptions:i,normalizedAttrs:r,imageModifiers:s}},de=["src"],le={__name:"NuxtImg",props:{custom:{type:Boolean,required:!1},placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[String,Number],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:null,required:!1},sizes:{type:[String,Object],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},crossorigin:{type:[String,Boolean],required:!1},nonce:{type:String,required:!1}},emits:["load","error"],setup(e,{expose:t,emit:i}){const r=e,s=i,o=k(),{providerOptions:a,normalizedAttrs:c,imageModifiers:f}=ce(r),g=p(()=>o.getSizes(r.src,{...a.value,sizes:r.sizes,densities:r.densities,modifiers:f.value})),u=R(!1),m=U(),h=p(()=>({...c.value,"data-nuxt-img":"",...!r.placeholder||u.value?{sizes:g.value.sizes,srcset:g.value.srcset}:{},...m})),w=p(()=>{if(u.value)return!1;const n=r.placeholder===""?[10,10]:r.placeholder;if(!n)return!1;if(typeof n=="string")return n;const[l=10,N=l,A=50,E=3]=Array.isArray(n)?n:typeof n=="number"?[n]:[];return o(r.src,{...f.value,width:l,height:N,quality:A,blur:E},a.value)}),v=p(()=>r.sizes?g.value.src:o(r.src,f.value,a.value)),S=p(()=>w.value||v.value),b=W().isHydrating,d=H("imgEl");return t({imgEl:d}),B(()=>{if(w.value||r.custom){const n=new Image;v.value&&(n.src=v.value),r.sizes&&(n.sizes=g.value.sizes||"",n.srcset=g.value.srcset),n.decode?n.decode().then(()=>{u.value=!0,s("load",new Event("load"))}).catch(l=>{s("error",l)}):(n.onload=l=>{u.value=!0,s("load",l)},n.onerror=l=>{s("error",l)}),ae("nuxt-image");return}d.value&&(d.value.complete&&b&&(d.value.getAttribute("data-error")?s("error",new Event("error")):s("load",new Event("load"))),d.value.onload=n=>{s("load",n)},d.value.onerror=n=>{s("error",n)})}),(n,l)=>e.custom?T(n.$slots,"default",J(z({key:1},{imgAttrs:h.value,isLoaded:u.value,src:S.value}))):(F(),D("img",z({key:0,ref_key:"imgEl",ref:d,class:w.value?e.placeholderClass:void 0},h.value,{src:S.value}),null,16,de))}},fe=Object.assign(le,{__name:"NuxtImg"});export{fe as _};
